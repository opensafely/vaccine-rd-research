
R version 4.0.2 (2020-06-22) -- "Taking Off Again"
Copyright (C) 2020 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> # load packages
> library('tidyverse')
-- Attaching packages --------------------------------------- tidyverse 1.3.0 --
v ggplot2 3.3.2     v purrr   0.3.4
v tibble  3.0.3     v dplyr   1.0.2
v tidyr   1.1.2     v stringr 1.4.0
v readr   1.3.1     v forcats 0.5.0
-- Conflicts ------------------------------------------ tidyverse_conflicts() --
x dplyr::filter() masks stats::filter()
x dplyr::lag()    masks stats::lag()
> 
> # tsls() taken from sem package from CRAN mirror
> # here https://github.com/cran/sem/blob/master/R/tsls.R
> source(here::here("analysis","tsls.R")) 
> 
> ## import data
> df_input <- read_csv(
+   here::here("output", "input_3.csv"),
+   col_types = cols(
+     # identifiers
+     patient_id = col_integer(),
+     practice_id = col_integer(),
+ 
+     # demographic / administrative
+     msoa = col_character(),
+     stp = col_character(),
+     region = col_character(),
+     imd = col_character(),
+     rural_urban = col_integer(),
+     care_home_type = col_character(),
+     care_home_tpp = col_logical(),
+     care_home_primis = col_logical(),
+     stp = col_character(),
+ 
+     registered_at_latest = col_logical(),
+     has_follow_up_previous_year = col_logical(),
+ 
+     age = col_integer(),
+     sex = col_character(),
+     # ethnicity = col_character(),
+     # ethnicity_6_sus = col_character(),
+     ethnicity_16 = col_character()
+ 
+   )
+ )
Warning: 811 parsing failures.
  row                 col           expected     actual                            file
 4483 covid_vax_3_date    1/0/T/F/TRUE/FALSE 2021-03-24 '/workspace/output/input_3.csv'
 4483 covid_vax_az_3_date 1/0/T/F/TRUE/FALSE 2021-03-24 '/workspace/output/input_3.csv'
10203 covid_vax_3_date    1/0/T/F/TRUE/FALSE 2021-04-01 '/workspace/output/input_3.csv'
12383 covid_vax_3_date    1/0/T/F/TRUE/FALSE 2021-04-06 '/workspace/output/input_3.csv'
12383 covid_vax_az_3_date 1/0/T/F/TRUE/FALSE 2021-04-06 '/workspace/output/input_3.csv'
..... ................... .................. .......... ...............................
See problems(...) for more details.

> 
> dim(df_input)
[1] 1507883      36
> class(df_input)
[1] "spec_tbl_df" "tbl_df"      "tbl"         "data.frame" 
> colnames(df_input)
 [1] "patient_id"                         "age"                               
 [3] "sex"                                "bmi"                               
 [5] "has_follow_up_previous_year"        "registered_at_latest"              
 [7] "ethnicity_16"                       "practice_id"                       
 [9] "msoa"                               "stp"                               
[11] "region"                             "imd"                               
[13] "rural_urban"                        "care_home_type"                    
[15] "care_home_tpp"                      "care_home_primis"                  
[17] "covid_vax_1_date"                   "covid_vax_2_date"                  
[19] "covid_vax_3_date"                   "covid_vax_4_date"                  
[21] "covid_vax_pfizer_1_date"            "covid_vax_pfizer_2_date"           
[23] "covid_vax_pfizer_3_date"            "covid_vax_pfizer_4_date"           
[25] "covid_vax_az_1_date"                "covid_vax_az_2_date"               
[27] "covid_vax_az_3_date"                "covid_vax_az_4_date"               
[29] "prior_positive_test_date"           "prior_primary_care_covid_case_date"
[31] "prior_admitted_for_covid_date"      "positive_test_1_date"              
[33] "primary_care_covid_case_1_date"     "admitted_1_date"                   
[35] "coviddeath_date"                    "death_date"                        
> sapply(df_input, class)
                        patient_id                                age 
                         "integer"                          "integer" 
                               sex                                bmi 
                       "character"                        "character" 
       has_follow_up_previous_year               registered_at_latest 
                         "logical"                          "logical" 
                      ethnicity_16                        practice_id 
                       "character"                          "integer" 
                              msoa                                stp 
                       "character"                        "character" 
                            region                                imd 
                       "character"                        "character" 
                       rural_urban                     care_home_type 
                         "integer"                        "character" 
                     care_home_tpp                   care_home_primis 
                         "logical"                          "logical" 
                  covid_vax_1_date                   covid_vax_2_date 
                            "Date"                             "Date" 
                  covid_vax_3_date                   covid_vax_4_date 
                         "logical"                          "logical" 
           covid_vax_pfizer_1_date            covid_vax_pfizer_2_date 
                            "Date"                             "Date" 
           covid_vax_pfizer_3_date            covid_vax_pfizer_4_date 
                         "logical"                          "logical" 
               covid_vax_az_1_date                covid_vax_az_2_date 
                            "Date"                             "Date" 
               covid_vax_az_3_date                covid_vax_az_4_date 
                         "logical"                          "logical" 
          prior_positive_test_date prior_primary_care_covid_case_date 
                            "Date"                             "Date" 
     prior_admitted_for_covid_date               positive_test_1_date 
                            "Date"                             "Date" 
    primary_care_covid_case_1_date                    admitted_1_date 
                            "Date"                             "Date" 
                   coviddeath_date                         death_date 
                            "Date"                             "Date" 
> 
> # greater than or equal to 80 indicator
> df_input <- df_input %>% 
+   mutate(gr80 = as.numeric(age >= 80))
> sum(is.na(df_input$gr80))
[1] 0
> table(df_input$gr80, useNA = "ifany")

     0      1 
888275 619608 
> 
> # non-care home residents
> class(df_input$care_home_type)
[1] "character"
> table(df_input$care_home_type, useNA = "ifany")

   Carehome       Mixed Nursinghome        <NA> 
      13533         671       13385     1480294 
> 
> class(df_input$care_home_tpp)
[1] "logical"
> table(df_input$care_home_tpp, useNA = "ifany")

  FALSE    TRUE 
1480294   27589 
> 
> class(df_input$care_home_primis)
[1] "logical"
> table(df_input$care_home_primis, useNA = "ifany")

  FALSE    TRUE 
1479225   28658 
> 
> df_input_tpp <- df_input %>%
+   filter(care_home_tpp == FALSE)
> dim(df_input_tpp)
[1] 1480294      37
> 
> df_input_primis <- df_input %>%
+   filter(care_home_primis == FALSE)
> dim(df_input_primis)
[1] 1479225      37
> 
> # setup week start and end dates
> startweek <- c("2020-12-07","2020-12-14","2020-12-21","2020-12-28","2021-01-04",
+               "2021-01-11","2021-01-18","2021-01-25","2021-02-01","2021-02-08",
+               "2021-02-15")
> endweek   <- c("2020-12-14","2020-12-21","2020-12-28","2021-01-04","2021-01-11",
+               "2021-01-18","2021-01-25","2021-02-01","2021-02-08","2021-02-15",
+               "2021-02-22")
> 
> # initialise lists for results and plots
> results_tpp <- results_primis <- pt_plot <- vector("list", length(startweek))
> 
> for (i in 1:length(startweek)) {
+   
+   # print iteration
+   print(paste("Week", i))
+   print(paste("Start date", startweek[i]))
+ 
+   # TPP
+   print("TPP")
+ 
+   # positive test in week
+   week_df_tpp <- df_input_tpp %>% 
+     mutate(pos_test_in_week = positive_test_1_date > startweek[i] &
+              positive_test_1_date <= endweek[i])
+   print("Week dataset dimensions")
+   print(dim(week_df_tpp))
+   # print(class(week_df_tpp$pos_test_in_week))
+   print("Positive tests in week")
+   print(table(week_df_tpp$pos_test_in_week))
+   
+   # pt_plot[[i]] <- df_input %>% 
+   #   drop_na(age, pos_test_in_week) %>%
+   #   filter(age >= 18) %>%
+   #   ggplot(aes(x = age, y = pos_test_in_week)) + 
+   #   geom_point() + 
+   #   theme_bw()
+   # 
+   # # save plots
+   # ggsave(
+   #   plot = pt_plot[[i]],
+   #   filename = paste0("pt_plot_week_", i, ".png"),
+   #   path = here::here("output"),
+   #   units = "cm",
+   #   height = 15,
+   #   width = 15
+   # )
+   
+   # fit IV estimator
+   ivfit <- try(tsls(as.numeric(pos_test_in_week) ~ age, ~ gr80, 
+                 data = week_df_tpp))
+   if (class(ivfit) != "try-error") {
+     results_tpp[[i]] <- ivfit
+     print(summary(ivfit))
+     print(cbind(coef(ivfit), confint.default(ivfit)))
+   }
+ 
+   # logistic regression of outcome on instrument
+   print("Logistic regression of outcome on instrument")
+   logreg <- glm(pos_test_in_week ~ gr80, family = "binomial", data = week_df_tpp)
+   if (class(logreg) != "try-error") {
+     print(summary(logreg))
+     print(exp(cbind(coef(logreg), confint.default(logreg))))
+   }
+ 
+   # primis
+   print("primis")
+ 
+   # positive test in week
+   week_df_primis <- df_input_primis %>% 
+     mutate(pos_test_in_week = positive_test_1_date > startweek[i] &
+              positive_test_1_date <= endweek[i])
+   print("Week dataset dimensions")
+   print(dim(week_df_primis))
+   # print(class(week_df_primis$pos_test_in_week))
+   print("Positive tests in week")
+   print(table(week_df_primis$pos_test_in_week))
+ 
+     # fit IV estimator
+   ivfit <- try(tsls(as.numeric(pos_test_in_week) ~ age, ~ gr80, 
+                 data = week_df_primis))
+   if (class(ivfit) != "try-error") {
+     results_primis[[i]] <- ivfit
+     print(summary(ivfit))
+     print(cbind(coef(ivfit), confint.default(ivfit)))
+   }
+ 
+   # logistic regression of outcome on instrument
+   print("Logistic regression of outcome on instrument")
+   logreg <- try(glm(pos_test_in_week ~ gr80, family = "binomial", data = week_df_tpp))
+   if (class(logreg) != "try-error") {
+     print(summary(logreg))
+     print(exp(cbind(coef(logreg), confint.default(logreg))))
+   }
+ }
[1] "Week 1"
[1] "Start date 2020-12-07"
[1] "TPP"
[1] "Week dataset dimensions"
[1] 1480294      38
[1] "Positive tests in week"

FALSE  TRUE 
21468  1401 

 2SLS Estimates

Model Formula: as.numeric(pos_test_in_week) ~ age

Instruments: ~gr80

Residuals:
    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
-0.07380 -0.06852 -0.06060  0.00000 -0.05267  0.94997 

                 Estimate    Std. Error  t value  Pr(>|t|)    
(Intercept) -0.1480099344  0.0495892897 -2.98472 0.0028414 ** 
age          0.0026405883  0.0006253967  4.22226 2.428e-05 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.2397454 on 22867 degrees of freedom

                                2.5 %       97.5 %
(Intercept) -0.148009934 -0.245203156 -0.050816713
age          0.002640588  0.001414833  0.003866343
[1] "Logistic regression of outcome on instrument"

Call:
glm(formula = pos_test_in_week ~ gr80, family = "binomial", data = week_df_tpp)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.3769  -0.3769  -0.3367  -0.3367   2.4076  

Coefficients:
            Estimate Std. Error z value Pr(>|z|)    
(Intercept) -2.84161    0.03933 -72.242  < 2e-16 ***
gr80         0.23248    0.05518   4.213 2.52e-05 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 10539  on 22868  degrees of freedom
Residual deviance: 10521  on 22867  degrees of freedom
  (1457425 observations deleted due to missingness)
AIC: 10525

Number of Fisher Scoring iterations: 5

                            2.5 %     97.5 %
(Intercept) 0.05833191 0.05400384 0.06300685
gr80        1.26172532 1.13239453 1.40582698
[1] "primis"
[1] "Week dataset dimensions"
[1] 1479225      38
[1] "Positive tests in week"

FALSE  TRUE 
21840  1446 

 2SLS Estimates

Model Formula: as.numeric(pos_test_in_week) ~ age

Instruments: ~gr80

Residuals:
    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
-0.07578 -0.06997 -0.06127  0.00000 -0.05256  0.95034 

                 Estimate    Std. Error  t value   Pr(>|t|)    
(Intercept) -0.1680497766  0.0493476455 -3.40543 0.00066172 ***
age          0.0029027338  0.0006220783  4.66619 3.0855e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.2412447 on 23284 degrees of freedom

                                2.5 %       97.5 %
(Intercept) -0.168049777 -0.264769384 -0.071330169
age          0.002902734  0.001683483  0.004121985
[1] "Logistic regression of outcome on instrument"

Call:
glm(formula = pos_test_in_week ~ gr80, family = "binomial", data = week_df_tpp)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.3769  -0.3769  -0.3367  -0.3367   2.4076  

Coefficients:
            Estimate Std. Error z value Pr(>|z|)    
(Intercept) -2.84161    0.03933 -72.242  < 2e-16 ***
gr80         0.23248    0.05518   4.213 2.52e-05 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 10539  on 22868  degrees of freedom
Residual deviance: 10521  on 22867  degrees of freedom
  (1457425 observations deleted due to missingness)
AIC: 10525

Number of Fisher Scoring iterations: 5

                            2.5 %     97.5 %
(Intercept) 0.05833191 0.05400384 0.06300685
gr80        1.26172532 1.13239453 1.40582698
[1] "Week 2"
[1] "Start date 2020-12-14"
[1] "TPP"
[1] "Week dataset dimensions"
[1] 1480294      38
[1] "Positive tests in week"

FALSE  TRUE 
21036  1833 

 2SLS Estimates

Model Formula: as.numeric(pos_test_in_week) ~ age

Instruments: ~gr80

Residuals:
    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
-0.08270 -0.08150 -0.07970  0.00000 -0.07851  0.92269 

                 Estimate    Std. Error  t value Pr(>|t|)  
(Intercept)  0.1276577120  0.0561651024  2.27290 0.023041 *
age         -0.0005994239  0.0007083278 -0.84625 0.397421  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.271537 on 22867 degrees of freedom

                                 2.5 %       97.5 %
(Intercept)  0.1276577120  0.017576134 0.2377392900
age         -0.0005994239 -0.001987721 0.0007888731
[1] "Logistic regression of outcome on instrument"

Call:
glm(formula = pos_test_in_week ~ gr80, family = "binomial", data = week_df_tpp)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.4125  -0.4125  -0.4043  -0.4043   2.2560  

Coefficients:
            Estimate Std. Error z value Pr(>|z|)    
(Intercept) -2.42151    0.03280 -73.825   <2e-16 ***
gr80        -0.04144    0.04897  -0.846    0.397    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 12767  on 22868  degrees of freedom
Residual deviance: 12767  on 22867  degrees of freedom
  (1457425 observations deleted due to missingness)
AIC: 12771

Number of Fisher Scoring iterations: 5

                            2.5 %     97.5 %
(Intercept) 0.08878751 0.08325915 0.09468294
gr80        0.95941030 0.87161468 1.05604935
[1] "primis"
[1] "Week dataset dimensions"
[1] 1479225      38
[1] "Positive tests in week"

FALSE  TRUE 
21394  1892 

 2SLS Estimates

Model Formula: as.numeric(pos_test_in_week) ~ age

Instruments: ~gr80

Residuals:
    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
-0.08195 -0.08162 -0.08113  0.00000 -0.08065  0.91952 

                 Estimate    Std. Error  t value Pr(>|t|)  
(Intercept)  0.0941468818  0.0558906606  1.68448 0.092102 .
age         -0.0001626553  0.0007045597 -0.23086 0.817425  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.2732314 on 23284 degrees of freedom

                                 2.5 %      97.5 %
(Intercept)  0.0941468818 -0.015396800 0.203690564
age         -0.0001626553 -0.001543567 0.001218256
[1] "Logistic regression of outcome on instrument"

Call:
glm(formula = pos_test_in_week ~ gr80, family = "binomial", data = week_df_tpp)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.4125  -0.4125  -0.4043  -0.4043   2.2560  

Coefficients:
            Estimate Std. Error z value Pr(>|z|)    
(Intercept) -2.42151    0.03280 -73.825   <2e-16 ***
gr80        -0.04144    0.04897  -0.846    0.397    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 12767  on 22868  degrees of freedom
Residual deviance: 12767  on 22867  degrees of freedom
  (1457425 observations deleted due to missingness)
AIC: 12771

Number of Fisher Scoring iterations: 5

                            2.5 %     97.5 %
(Intercept) 0.08878751 0.08325915 0.09468294
gr80        0.95941030 0.87161468 1.05604935
[1] "Week 3"
[1] "Start date 2020-12-21"
[1] "TPP"
[1] "Week dataset dimensions"
[1] 1480294      38
[1] "Positive tests in week"

FALSE  TRUE 
20785  2084 

 2SLS Estimates

Model Formula: as.numeric(pos_test_in_week) ~ age

Instruments: ~gr80

Residuals:
    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
-0.09379 -0.09254 -0.09066  0.00000 -0.08878  0.91185 

                 Estimate    Std. Error  t value Pr(>|t|)  
(Intercept)  0.1408103268  0.0595273314  2.36547 0.018015 *
age         -0.0006268939  0.0007507306 -0.83505 0.403701  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.2877921 on 22867 degrees of freedom

                                 2.5 %      97.5 %
(Intercept)  0.1408103268  0.024138901 0.257481752
age         -0.0006268939 -0.002098299 0.000844511
[1] "Logistic regression of outcome on instrument"

Call:
glm(formula = pos_test_in_week ~ gr80, family = "binomial", data = week_df_tpp)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.4408  -0.4408  -0.4328  -0.4328   2.1976  

Coefficients:
            Estimate Std. Error z value Pr(>|z|)    
(Intercept) -2.28245    0.03097 -73.699   <2e-16 ***
gr80        -0.03857    0.04619  -0.835    0.404    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 13956  on 22868  degrees of freedom
Residual deviance: 13956  on 22867  degrees of freedom
  (1457425 observations deleted due to missingness)
AIC: 13960

Number of Fisher Scoring iterations: 5

                          2.5 %    97.5 %
(Intercept) 0.1020336 0.0960244 0.1084188
gr80        0.9621641 0.8788829 1.0533369
[1] "primis"
[1] "Week dataset dimensions"
[1] 1479225      38
[1] "Positive tests in week"

FALSE  TRUE 
21158  2128 

 2SLS Estimates

Model Formula: as.numeric(pos_test_in_week) ~ age

Instruments: ~gr80

Residuals:
    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
-0.09560 -0.09364 -0.09068  0.00000 -0.08773  0.91325 

                 Estimate    Std. Error  t value  Pr(>|t|)   
(Intercept)  0.1694239506  0.0589416082  2.87444 0.0040511 **
age         -0.0009842623  0.0007430201 -1.32468 0.1852910   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.2881464 on 23284 degrees of freedom

                                 2.5 %       97.5 %
(Intercept)  0.1694239506  0.053900521 0.2849473798
age         -0.0009842623 -0.002440555 0.0004720303
[1] "Logistic regression of outcome on instrument"

Call:
glm(formula = pos_test_in_week ~ gr80, family = "binomial", data = week_df_tpp)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.4408  -0.4408  -0.4328  -0.4328   2.1976  

Coefficients:
            Estimate Std. Error z value Pr(>|z|)    
(Intercept) -2.28245    0.03097 -73.699   <2e-16 ***
gr80        -0.03857    0.04619  -0.835    0.404    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 13956  on 22868  degrees of freedom
Residual deviance: 13956  on 22867  degrees of freedom
  (1457425 observations deleted due to missingness)
AIC: 13960

Number of Fisher Scoring iterations: 5

                          2.5 %    97.5 %
(Intercept) 0.1020336 0.0960244 0.1084188
gr80        0.9621641 0.8788829 1.0533369
[1] "Week 4"
[1] "Start date 2020-12-28"
[1] "TPP"
[1] "Week dataset dimensions"
[1] 1480294      38
[1] "Positive tests in week"

FALSE  TRUE 
19159  3710 

 2SLS Estimates

Model Formula: as.numeric(pos_test_in_week) ~ age

Instruments: ~gr80

Residuals:
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
-0.1753 -0.1691 -0.1599  0.0000 -0.1507  0.8524 

                 Estimate    Std. Error  t value   Pr(>|t|)    
(Intercept)  0.4057615284  0.0762276016  5.32303 1.0302e-07 ***
age         -0.0030728964  0.0009613465 -3.19645  0.0013932 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.3685316 on 22867 degrees of freedom

                                2.5 %       97.5 %
(Intercept)  0.405761528  0.256358175  0.555164882
age         -0.003072896 -0.004957101 -0.001188692
[1] "Logistic regression of outcome on instrument"

Call:
glm(formula = pos_test_in_week ~ gr80, family = "binomial", data = week_df_tpp)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.6092  -0.6092  -0.5778  -0.5778   1.9352  

Coefficients:
            Estimate Std. Error z value Pr(>|z|)    
(Intercept) -1.59003    0.02393 -66.441   <2e-16 ***
gr80        -0.11551    0.03616  -3.194   0.0014 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 20278  on 22868  degrees of freedom
Residual deviance: 20268  on 22867  degrees of freedom
  (1457425 observations deleted due to missingness)
AIC: 20272

Number of Fisher Scoring iterations: 3

                          2.5 %    97.5 %
(Intercept) 0.2039193 0.1945754 0.2137119
gr80        0.8909132 0.8299587 0.9563444
[1] "primis"
[1] "Week dataset dimensions"
[1] 1479225      38
[1] "Positive tests in week"

FALSE  TRUE 
19531  3755 

 2SLS Estimates

Model Formula: as.numeric(pos_test_in_week) ~ age

Instruments: ~gr80

Residuals:
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
-0.1744 -0.1682 -0.1591  0.0000 -0.1499  0.8531 

                 Estimate    Std. Error  t value   Pr(>|t|)    
(Intercept)  0.4035559749  0.0751988473  5.36652 8.1038e-08 ***
age         -0.0030560150  0.0009479595 -3.22378  0.0012668 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.3676228 on 23284 degrees of freedom

                                2.5 %       97.5 %
(Intercept)  0.403555975  0.256168943  0.550943007
age         -0.003056015 -0.004913981 -0.001198049
[1] "Logistic regression of outcome on instrument"

Call:
glm(formula = pos_test_in_week ~ gr80, family = "binomial", data = week_df_tpp)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.6092  -0.6092  -0.5778  -0.5778   1.9352  

Coefficients:
            Estimate Std. Error z value Pr(>|z|)    
(Intercept) -1.59003    0.02393 -66.441   <2e-16 ***
gr80        -0.11551    0.03616  -3.194   0.0014 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 20278  on 22868  degrees of freedom
Residual deviance: 20268  on 22867  degrees of freedom
  (1457425 observations deleted due to missingness)
AIC: 20272

Number of Fisher Scoring iterations: 3

                          2.5 %    97.5 %
(Intercept) 0.2039193 0.1945754 0.2137119
gr80        0.8909132 0.8299587 0.9563444
[1] "Week 5"
[1] "Start date 2021-01-04"
[1] "TPP"
[1] "Week dataset dimensions"
[1] 1480294      38
[1] "Positive tests in week"

FALSE  TRUE 
19232  3637 

 2SLS Estimates

Model Formula: as.numeric(pos_test_in_week) ~ age

Instruments: ~gr80

Residuals:
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
-0.1600 -0.1594 -0.1588  0.0000 -0.1582  0.8418 

                Estimate   Std. Error t value Pr(>|t|)  
(Intercept) 0.1435596129 0.0756472331 1.89775 0.057741 .
age         0.0001952839 0.0009540272 0.20469 0.837813  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.3657257 on 22867 degrees of freedom

                                2.5 %      97.5 %
(Intercept) 0.1435596129 -0.004706240 0.291825465
age         0.0001952839 -0.001674575 0.002065143
[1] "Logistic regression of outcome on instrument"

Call:
glm(formula = pos_test_in_week ~ gr80, family = "binomial", data = week_df_tpp)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.5897  -0.5897  -0.5877  -0.5877   1.9191  

Coefficients:
             Estimate Std. Error z value Pr(>|z|)    
(Intercept) -1.668818   0.024574 -67.910   <2e-16 ***
gr80         0.007428   0.036288   0.205    0.838    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 20036  on 22868  degrees of freedom
Residual deviance: 20036  on 22867  degrees of freedom
  (1457425 observations deleted due to missingness)
AIC: 20040

Number of Fisher Scoring iterations: 3

                          2.5 %    97.5 %
(Intercept) 0.1884696 0.1796073 0.1977693
gr80        1.0074559 0.9382915 1.0817187
[1] "primis"
[1] "Week dataset dimensions"
[1] 1479225      38
[1] "Positive tests in week"

FALSE  TRUE 
19574  3712 

 2SLS Estimates

Model Formula: as.numeric(pos_test_in_week) ~ age

Instruments: ~gr80

Residuals:
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
-0.1618 -0.1603 -0.1588  0.0000 -0.1573  0.8427 

                Estimate   Std. Error t value Pr(>|t|)
(Intercept) 0.1198310787 0.0748810981 1.60028  0.10955
age         0.0004991781 0.0009439539 0.52882  0.59694

Residual standard error: 0.3660695 on 23284 degrees of freedom

                                2.5 %      97.5 %
(Intercept) 0.1198310787 -0.026933177 0.266595334
age         0.0004991781 -0.001350938 0.002349294
[1] "Logistic regression of outcome on instrument"

Call:
glm(formula = pos_test_in_week ~ gr80, family = "binomial", data = week_df_tpp)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.5897  -0.5897  -0.5877  -0.5877   1.9191  

Coefficients:
             Estimate Std. Error z value Pr(>|z|)    
(Intercept) -1.668818   0.024574 -67.910   <2e-16 ***
gr80         0.007428   0.036288   0.205    0.838    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 20036  on 22868  degrees of freedom
Residual deviance: 20036  on 22867  degrees of freedom
  (1457425 observations deleted due to missingness)
AIC: 20040

Number of Fisher Scoring iterations: 3

                          2.5 %    97.5 %
(Intercept) 0.1884696 0.1796073 0.1977693
gr80        1.0074559 0.9382915 1.0817187
[1] "Week 6"
[1] "Start date 2021-01-11"
[1] "TPP"
[1] "Week dataset dimensions"
[1] 1480294      38
[1] "Positive tests in week"

FALSE  TRUE 
19861  3008 

 2SLS Estimates

Model Formula: as.numeric(pos_test_in_week) ~ age

Instruments: ~gr80

Residuals:
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
-0.1382 -0.1340 -0.1298  0.0000 -0.1270  0.8744 

                Estimate   Std. Error t value Pr(>|t|)
(Intercept) 0.0209170948 0.0699068896 0.29921  0.76478
age         0.0013957335 0.0008816327 1.58312  0.11341

Residual standard error: 0.3379733 on 22867 degrees of freedom

                                2.5 %      97.5 %
(Intercept) 0.020917095 -0.1160978911 0.157932081
age         0.001395734 -0.0003322348 0.003123702
[1] "Logistic regression of outcome on instrument"

Call:
glm(formula = pos_test_in_week ~ gr80, family = "binomial", data = week_df_tpp)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.5394  -0.5394  -0.5240  -0.5240   2.0266  

Coefficients:
            Estimate Std. Error z value Pr(>|z|)    
(Intercept) -1.91622    0.02684 -71.385   <2e-16 ***
gr80         0.06207    0.03921   1.583    0.113    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 17805  on 22868  degrees of freedom
Residual deviance: 17803  on 22867  degrees of freedom
  (1457425 observations deleted due to missingness)
AIC: 17807

Number of Fisher Scoring iterations: 4

                          2.5 %   97.5 %
(Intercept) 0.1471621 0.1396197 0.155112
gr80        1.0640319 0.9853252 1.149026
[1] "primis"
[1] "Week dataset dimensions"
[1] 1479225      38
[1] "Positive tests in week"

FALSE  TRUE 
20213  3073 

 2SLS Estimates

Model Formula: as.numeric(pos_test_in_week) ~ age

Instruments: ~gr80

Residuals:
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
-0.1383 -0.1343 -0.1302  0.0000 -0.1276  0.8738 

                Estimate   Std. Error t value Pr(>|t|)
(Intercept) 0.0257772752 0.0692301974 0.37234  0.70964
age         0.0013393280 0.0008727184 1.53466  0.12488

Residual standard error: 0.338444 on 23284 degrees of freedom

                                2.5 %      97.5 %
(Intercept) 0.025777275 -0.1099114183 0.161465969
age         0.001339328 -0.0003711687 0.003049825
[1] "Logistic regression of outcome on instrument"

Call:
glm(formula = pos_test_in_week ~ gr80, family = "binomial", data = week_df_tpp)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.5394  -0.5394  -0.5240  -0.5240   2.0266  

Coefficients:
            Estimate Std. Error z value Pr(>|z|)    
(Intercept) -1.91622    0.02684 -71.385   <2e-16 ***
gr80         0.06207    0.03921   1.583    0.113    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 17805  on 22868  degrees of freedom
Residual deviance: 17803  on 22867  degrees of freedom
  (1457425 observations deleted due to missingness)
AIC: 17807

Number of Fisher Scoring iterations: 4

                          2.5 %   97.5 %
(Intercept) 0.1471621 0.1396197 0.155112
gr80        1.0640319 0.9853252 1.149026
[1] "Week 7"
[1] "Start date 2021-01-18"
[1] "TPP"
[1] "Week dataset dimensions"
[1] 1480294      38
[1] "Positive tests in week"

FALSE  TRUE 
20495  2374 

 2SLS Estimates

Model Formula: as.numeric(pos_test_in_week) ~ age

Instruments: ~gr80

Residuals:
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
-0.1086 -0.1056 -0.1025  0.0000 -0.1005  0.9005 

                Estimate   Std. Error t value Pr(>|t|)
(Intercept) 0.0235001205 0.0630888852 0.37249  0.70953
age         0.0010133312 0.0007956473 1.27359  0.20282

Residual standard error: 0.3050108 on 22867 degrees of freedom

                                2.5 %      97.5 %
(Intercept) 0.023500121 -0.1001518223 0.147152063
age         0.001013331 -0.0005461087 0.002572771
[1] "Logistic regression of outcome on instrument"

Call:
glm(formula = pos_test_in_week ~ gr80, family = "binomial", data = week_df_tpp)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.4748  -0.4748  -0.4625  -0.4625   2.1393  

Coefficients:
            Estimate Std. Error z value Pr(>|z|)    
(Intercept) -2.18121    0.02973 -73.369   <2e-16 ***
gr80         0.05533    0.04345   1.274    0.203    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 15248  on 22868  degrees of freedom
Residual deviance: 15246  on 22867  degrees of freedom
  (1457425 observations deleted due to missingness)
AIC: 15250

Number of Fisher Scoring iterations: 4

                          2.5 %    97.5 %
(Intercept) 0.1129047 0.1065139 0.1196789
gr80        1.0568908 0.9706173 1.1508327
[1] "primis"
[1] "Week dataset dimensions"
[1] 1479225      38
[1] "Positive tests in week"

FALSE  TRUE 
20862  2424 

 2SLS Estimates

Model Formula: as.numeric(pos_test_in_week) ~ age

Instruments: ~gr80

Residuals:
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
-0.1078 -0.1054 -0.1031  0.0000 -0.1015  0.8992 

                Estimate   Std. Error t value Pr(>|t|)
(Intercept) 0.0424579335 0.0624687688 0.67967  0.49672
age         0.0007774219 0.0007874836 0.98722  0.32354

Residual standard error: 0.3053896 on 23284 degrees of freedom

                                 2.5 %      97.5 %
(Intercept) 0.0424579335 -0.0799786035 0.164894471
age         0.0007774219 -0.0007660176 0.002320861
[1] "Logistic regression of outcome on instrument"

Call:
glm(formula = pos_test_in_week ~ gr80, family = "binomial", data = week_df_tpp)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.4748  -0.4748  -0.4625  -0.4625   2.1393  

Coefficients:
            Estimate Std. Error z value Pr(>|z|)    
(Intercept) -2.18121    0.02973 -73.369   <2e-16 ***
gr80         0.05533    0.04345   1.274    0.203    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 15248  on 22868  degrees of freedom
Residual deviance: 15246  on 22867  degrees of freedom
  (1457425 observations deleted due to missingness)
AIC: 15250

Number of Fisher Scoring iterations: 4

                          2.5 %    97.5 %
(Intercept) 0.1129047 0.1065139 0.1196789
gr80        1.0568908 0.9706173 1.1508327
[1] "Week 8"
[1] "Start date 2021-01-25"
[1] "TPP"
[1] "Week dataset dimensions"
[1] 1480294      38
[1] "Positive tests in week"

FALSE  TRUE 
21104  1765 

 2SLS Estimates

Model Formula: as.numeric(pos_test_in_week) ~ age

Instruments: ~gr80

Residuals:
    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
-0.07846 -0.07792 -0.07711  0.00000 -0.07630  0.92397 

                Estimate   Std. Error t value Pr(>|t|)
(Intercept) 0.0558077118 0.0552026141 1.01096  0.31205
age         0.0002696588 0.0006961893 0.38734  0.69851

Residual standard error: 0.2668837 on 22867 degrees of freedom

                                2.5 %      97.5 %
(Intercept) 0.0558077118 -0.052387424 0.164002847
age         0.0002696588 -0.001094847 0.001634165
[1] "Logistic regression of outcome on instrument"

Call:
glm(formula = pos_test_in_week ~ gr80, family = "binomial", data = week_df_tpp)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.4028  -0.4028  -0.3991  -0.3991   2.2671  

Coefficients:
            Estimate Std. Error z value Pr(>|z|)    
(Intercept) -2.49016    0.03376 -73.756   <2e-16 ***
gr80         0.01925    0.04970   0.387    0.699    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 12433  on 22868  degrees of freedom
Residual deviance: 12433  on 22867  degrees of freedom
  (1457425 observations deleted due to missingness)
AIC: 12437

Number of Fisher Scoring iterations: 5

                            2.5 %     97.5 %
(Intercept) 0.08289703 0.07758906 0.08856813
gr80        1.01943941 0.92481008 1.12375150
[1] "primis"
[1] "Week dataset dimensions"
[1] 1479225      38
[1] "Positive tests in week"

FALSE  TRUE 
21498  1788 

 2SLS Estimates

Model Formula: as.numeric(pos_test_in_week) ~ age

Instruments: ~gr80

Residuals:
    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
-0.07764 -0.07728 -0.07673  0.00000 -0.07619  0.92399 

                Estimate   Std. Error t value Pr(>|t|)
(Intercept) 0.0624312912 0.0544643698 1.14628  0.25169
age         0.0001810279 0.0006865799 0.26367  0.79204

Residual standard error: 0.2662587 on 23284 degrees of freedom

                                2.5 %    97.5 %
(Intercept) 0.0624312912 -0.044316912 0.1691795
age         0.0001810279 -0.001164644 0.0015267
[1] "Logistic regression of outcome on instrument"

Call:
glm(formula = pos_test_in_week ~ gr80, family = "binomial", data = week_df_tpp)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.4028  -0.4028  -0.3991  -0.3991   2.2671  

Coefficients:
            Estimate Std. Error z value Pr(>|z|)    
(Intercept) -2.49016    0.03376 -73.756   <2e-16 ***
gr80         0.01925    0.04970   0.387    0.699    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 12433  on 22868  degrees of freedom
Residual deviance: 12433  on 22867  degrees of freedom
  (1457425 observations deleted due to missingness)
AIC: 12437

Number of Fisher Scoring iterations: 5

                            2.5 %     97.5 %
(Intercept) 0.08289703 0.07758906 0.08856813
gr80        1.01943941 0.92481008 1.12375150
[1] "Week 9"
[1] "Start date 2021-02-01"
[1] "TPP"
[1] "Week dataset dimensions"
[1] 1480294      38
[1] "Positive tests in week"

FALSE  TRUE 
21590  1279 

 2SLS Estimates

Model Formula: as.numeric(pos_test_in_week) ~ age

Instruments: ~gr80

Residuals:
    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
-0.05665 -0.05631 -0.05597  0.00000 -0.05546  0.94489 

                 Estimate    Std. Error  t value Pr(>|t|)
(Intercept)  0.0694915241  0.0475303269  1.46205  0.14374
age         -0.0001711539  0.0005994301 -0.28553  0.77524

Residual standard error: 0.2297911 on 22867 degrees of freedom

                                 2.5 %      97.5 %
(Intercept)  0.0694915241 -0.023666205 0.162649253
age         -0.0001711539 -0.001346015 0.001003707
[1] "Logistic regression of outcome on instrument"

Call:
glm(formula = pos_test_in_week ~ gr80, family = "binomial", data = week_df_tpp)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.3405  -0.3405  -0.3405  -0.3378   2.4051  

Coefficients:
            Estimate Std. Error z value Pr(>|z|)    
(Intercept) -2.81863    0.03894 -72.393   <2e-16 ***
gr80        -0.01651    0.05780  -0.286    0.775    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 9861.6  on 22868  degrees of freedom
Residual deviance: 9861.5  on 22867  degrees of freedom
  (1457425 observations deleted due to missingness)
AIC: 9865.5

Number of Fisher Scoring iterations: 5

                            2.5 %     97.5 %
(Intercept) 0.05968747 0.05530208 0.06442062
gr80        0.98363011 0.87827284 1.10162599
[1] "primis"
[1] "Week dataset dimensions"
[1] 1479225      38
[1] "Positive tests in week"

FALSE  TRUE 
22000  1286 

 2SLS Estimates

Model Formula: as.numeric(pos_test_in_week) ~ age

Instruments: ~gr80

Residuals:
    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
-0.05687 -0.05610 -0.05534  0.00000 -0.05419  0.94658 

                 Estimate    Std. Error  t value Pr(>|t|)  
(Intercept)  0.0855476470  0.0467263063  1.83082  0.06714 .
age         -0.0003824281  0.0005890336 -0.64925  0.51619  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.2284298 on 23284 degrees of freedom

                                 2.5 %       97.5 %
(Intercept)  0.0855476470 -0.006034230 0.1771295245
age         -0.0003824281 -0.001536913 0.0007720564
[1] "Logistic regression of outcome on instrument"

Call:
glm(formula = pos_test_in_week ~ gr80, family = "binomial", data = week_df_tpp)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.3405  -0.3405  -0.3405  -0.3378   2.4051  

Coefficients:
            Estimate Std. Error z value Pr(>|z|)    
(Intercept) -2.81863    0.03894 -72.393   <2e-16 ***
gr80        -0.01651    0.05780  -0.286    0.775    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 9861.6  on 22868  degrees of freedom
Residual deviance: 9861.5  on 22867  degrees of freedom
  (1457425 observations deleted due to missingness)
AIC: 9865.5

Number of Fisher Scoring iterations: 5

                            2.5 %     97.5 %
(Intercept) 0.05968747 0.05530208 0.06442062
gr80        0.98363011 0.87827284 1.10162599
[1] "Week 10"
[1] "Start date 2021-02-08"
[1] "TPP"
[1] "Week dataset dimensions"
[1] 1480294      38
[1] "Positive tests in week"

FALSE  TRUE 
21972   897 

 2SLS Estimates

Model Formula: as.numeric(pos_test_in_week) ~ age

Instruments: ~gr80

Residuals:
    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
-0.04603 -0.04283 -0.03963  0.00000 -0.03482  0.96838 

                Estimate   Std. Error  t value   Pr(>|t|)    
(Intercept)  0.166106316  0.040153738  4.13676 3.5351e-05 ***
age         -0.001601006  0.000506400 -3.16154  0.0015714 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.1941281 on 22867 degrees of freedom

                                2.5 %        97.5 %
(Intercept)  0.166106316  0.087406437  0.2448061955
age         -0.001601006 -0.002593532 -0.0006084801
[1] "Logistic regression of outcome on instrument"

Call:
glm(formula = pos_test_in_week ~ gr80, family = "binomial", data = week_df_tpp)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.2963  -0.2963  -0.2963  -0.2662   2.5915  

Coefficients:
            Estimate Std. Error z value Pr(>|z|)    
(Intercept) -3.10384    0.04428 -70.102   <2e-16 ***
gr80        -0.21880    0.06933  -3.156   0.0016 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 7568.2  on 22868  degrees of freedom
Residual deviance: 7558.1  on 22867  degrees of freedom
  (1457425 observations deleted due to missingness)
AIC: 7562.1

Number of Fisher Scoring iterations: 6

                            2.5 %    97.5 %
(Intercept) 0.04487665 0.04114647 0.0489450
gr80        0.80347914 0.70139170 0.9204254
[1] "primis"
[1] "Week dataset dimensions"
[1] 1479225      38
[1] "Positive tests in week"

FALSE  TRUE 
22387   899 

 2SLS Estimates

Model Formula: as.numeric(pos_test_in_week) ~ age

Instruments: ~gr80

Residuals:
    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
-0.04589 -0.04249 -0.03909  0.00000 -0.03400  0.96940 

                 Estimate    Std. Error  t value   Pr(>|t|)    
(Intercept)  0.1733427800  0.0394092560  4.39853 1.0947e-05 ***
age         -0.0016993579  0.0004967945 -3.42065  0.0006258 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.1926591 on 23284 degrees of freedom

                                2.5 %        97.5 %
(Intercept)  0.173342780  0.096102058  0.2505835024
age         -0.001699358 -0.002673057 -0.0007256585
[1] "Logistic regression of outcome on instrument"

Call:
glm(formula = pos_test_in_week ~ gr80, family = "binomial", data = week_df_tpp)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.2963  -0.2963  -0.2963  -0.2662   2.5915  

Coefficients:
            Estimate Std. Error z value Pr(>|z|)    
(Intercept) -3.10384    0.04428 -70.102   <2e-16 ***
gr80        -0.21880    0.06933  -3.156   0.0016 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 7568.2  on 22868  degrees of freedom
Residual deviance: 7558.1  on 22867  degrees of freedom
  (1457425 observations deleted due to missingness)
AIC: 7562.1

Number of Fisher Scoring iterations: 6

                            2.5 %    97.5 %
(Intercept) 0.04487665 0.04114647 0.0489450
gr80        0.80347914 0.70139170 0.9204254
[1] "Week 11"
[1] "Start date 2021-02-15"
[1] "TPP"
[1] "Week dataset dimensions"
[1] 1480294      38
[1] "Positive tests in week"

FALSE  TRUE 
22199   670 

 2SLS Estimates

Model Formula: as.numeric(pos_test_in_week) ~ age

Instruments: ~gr80

Residuals:
    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
-0.02951 -0.02941 -0.02931  0.00000 -0.02916  0.97094 

                 Estimate    Std. Error  t value Pr(>|t|)
(Intercept)  0.0331953200  0.0348831523  0.95161  0.34130
age         -0.0000491851  0.0004399299 -0.11180  0.91098

Residual standard error: 0.1686468 on 22867 degrees of freedom

                                  2.5 %       97.5 %
(Intercept)  0.0331953199 -0.0351744023 0.1015650421
age         -0.0000491851 -0.0009114318 0.0008130616
[1] "Logistic regression of outcome on instrument"

Call:
glm(formula = pos_test_in_week ~ gr80, family = "binomial", data = week_df_tpp)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.2444  -0.2444  -0.2444  -0.2433   2.6589  

Coefficients:
             Estimate Std. Error z value Pr(>|z|)    
(Intercept) -3.496508   0.053129 -65.811   <2e-16 ***
gr80        -0.008804   0.078739  -0.112    0.911    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 6050.7  on 22868  degrees of freedom
Residual deviance: 6050.7  on 22867  degrees of freedom
  (1457425 observations deleted due to missingness)
AIC: 6054.7

Number of Fisher Scoring iterations: 6

                            2.5 %     97.5 %
(Intercept) 0.03030303 0.02730626 0.03362869
gr80        0.99123498 0.84948075 1.15664397
[1] "primis"
[1] "Week dataset dimensions"
[1] 1479225      38
[1] "Positive tests in week"

FALSE  TRUE 
22618   668 

 2SLS Estimates

Model Formula: as.numeric(pos_test_in_week) ~ age

Instruments: ~gr80

Residuals:
    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
-0.02872 -0.02870 -0.02869  0.00000 -0.02867  0.97135 

                 Estimate    Std. Error  t value Pr(>|t|)
(Intercept)  2.926349e-02  3.414664e-02  0.85699  0.39146
age         -7.273950e-06  4.304539e-04 -0.01690  0.98652

Residual standard error: 0.1669319 on 23284 degrees of freedom

                                 2.5 %       97.5 %
(Intercept)  2.926349e-02 -0.037662705 0.0961896839
age         -7.273950e-06 -0.000850948 0.0008364001
[1] "Logistic regression of outcome on instrument"

Call:
glm(formula = pos_test_in_week ~ gr80, family = "binomial", data = week_df_tpp)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.2444  -0.2444  -0.2444  -0.2433   2.6589  

Coefficients:
             Estimate Std. Error z value Pr(>|z|)    
(Intercept) -3.496508   0.053129 -65.811   <2e-16 ***
gr80        -0.008804   0.078739  -0.112    0.911    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 6050.7  on 22868  degrees of freedom
Residual deviance: 6050.7  on 22867  degrees of freedom
  (1457425 observations deleted due to missingness)
AIC: 6054.7

Number of Fisher Scoring iterations: 6

                            2.5 %     97.5 %
(Intercept) 0.03030303 0.02730626 0.03362869
gr80        0.99123498 0.84948075 1.15664397
There were 22 warnings (use warnings() to see them)
> 
> proc.time()
   user  system elapsed 
 33.110   1.030  34.184 
