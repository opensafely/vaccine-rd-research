
R version 4.0.2 (2020-06-22) -- "Taking Off Again"
Copyright (C) 2020 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> # load packages
> library('tidyverse')
-- Attaching packages --------------------------------------- tidyverse 1.3.0 --
v ggplot2 3.3.2     v purrr   0.3.4
v tibble  3.0.3     v dplyr   1.0.2
v tidyr   1.1.2     v stringr 1.4.0
v readr   1.3.1     v forcats 0.5.0
-- Conflicts ------------------------------------------ tidyverse_conflicts() --
x dplyr::filter() masks stats::filter()
x dplyr::lag()    masks stats::lag()
> 
> # tsls() taken from sem package from CRAN mirror
> # here https://github.com/cran/sem/blob/master/R/tsls.R
> source(here::here("analysis","tsls.R")) 
> 
> ## import data
> df_input <- read_csv(
+   here::here("output", "input_3.csv"),
+   col_types = cols(
+     # identifiers
+     patient_id = col_integer(),
+     practice_id = col_integer(),
+ 
+     # demographic / administrative
+     msoa = col_character(),
+     stp = col_character(),
+     region = col_character(),
+     imd = col_character(),
+     rural_urban = col_integer(),
+     care_home_type = col_character(),
+     care_home_tpp = col_logical(),
+     care_home_primis = col_logical(),
+     stp = col_character(),
+ 
+     registered_at_latest = col_logical(),
+     has_follow_up_previous_year = col_logical(),
+ 
+     age = col_integer(),
+     sex = col_character(),
+     # ethnicity = col_character(),
+     # ethnicity_6_sus = col_character(),
+     ethnicity_16 = col_character()
+ 
+   )
+ )
> 
> dim(df_input)
[1] 10000    36
> class(df_input)
[1] "spec_tbl_df" "tbl_df"      "tbl"         "data.frame" 
> colnames(df_input)
 [1] "covid_vax_1_date"                   "covid_vax_2_date"                  
 [3] "covid_vax_3_date"                   "covid_vax_4_date"                  
 [5] "covid_vax_pfizer_1_date"            "covid_vax_pfizer_2_date"           
 [7] "covid_vax_pfizer_3_date"            "covid_vax_pfizer_4_date"           
 [9] "covid_vax_az_1_date"                "covid_vax_az_2_date"               
[11] "covid_vax_az_3_date"                "covid_vax_az_4_date"               
[13] "prior_positive_test_date"           "prior_primary_care_covid_case_date"
[15] "prior_admitted_for_covid_date"      "positive_test_1_date"              
[17] "primary_care_covid_case_1_date"     "admitted_1_date"                   
[19] "coviddeath_date"                    "death_date"                        
[21] "age"                                "sex"                               
[23] "bmi"                                "has_follow_up_previous_year"       
[25] "registered_at_latest"               "ethnicity_16"                      
[27] "practice_id"                        "msoa"                              
[29] "stp"                                "region"                            
[31] "imd"                                "rural_urban"                       
[33] "care_home_type"                     "care_home_tpp"                     
[35] "care_home_primis"                   "patient_id"                        
> sapply(df_input, class)
                  covid_vax_1_date                   covid_vax_2_date 
                            "Date"                             "Date" 
                  covid_vax_3_date                   covid_vax_4_date 
                            "Date"                             "Date" 
           covid_vax_pfizer_1_date            covid_vax_pfizer_2_date 
                            "Date"                             "Date" 
           covid_vax_pfizer_3_date            covid_vax_pfizer_4_date 
                            "Date"                             "Date" 
               covid_vax_az_1_date                covid_vax_az_2_date 
                            "Date"                             "Date" 
               covid_vax_az_3_date                covid_vax_az_4_date 
                            "Date"                             "Date" 
          prior_positive_test_date prior_primary_care_covid_case_date 
                            "Date"                             "Date" 
     prior_admitted_for_covid_date               positive_test_1_date 
                            "Date"                             "Date" 
    primary_care_covid_case_1_date                    admitted_1_date 
                            "Date"                             "Date" 
                   coviddeath_date                         death_date 
                            "Date"                             "Date" 
                               age                                sex 
                         "integer"                        "character" 
                               bmi        has_follow_up_previous_year 
                       "character"                          "logical" 
              registered_at_latest                       ethnicity_16 
                         "logical"                        "character" 
                       practice_id                               msoa 
                         "integer"                        "character" 
                               stp                             region 
                       "character"                        "character" 
                               imd                        rural_urban 
                       "character"                          "integer" 
                    care_home_type                      care_home_tpp 
                       "character"                          "logical" 
                  care_home_primis                         patient_id 
                         "logical"                          "integer" 
> 
> # greater than or equal to 80 indicator
> df_input <- df_input %>% 
+   mutate(gr80 = as.numeric(age >= 80))
> sum(is.na(df_input$gr80))
[1] 0
> table(df_input$gr80, useNA = "ifany")

   0    1 
9554  446 
> 
> # non-care home residents
> class(df_input$care_home_type)
[1] "character"
> table(df_input$care_home_type, useNA = "ifany")

   Carehome       Mixed Nursinghome        <NA> 
        498         564         490        8448 
> 
> class(df_input$care_home_tpp)
[1] "logical"
> table(df_input$care_home_tpp, useNA = "ifany")

FALSE  TRUE 
 9000  1000 
> 
> class(df_input$care_home_primis)
[1] "logical"
> table(df_input$care_home_primis, useNA = "ifany")

FALSE  TRUE 
 9000  1000 
> 
> df_input_tpp <- df_input %>%
+   filter(care_home_tpp == FALSE)
> dim(df_input_tpp)
[1] 9000   37
> 
> df_input_primis <- df_input %>%
+   filter(care_home_primis == FALSE)
> dim(df_input_primis)
[1] 9000   37
> 
> # setup week start and end dates
> startweek <- c("2020-12-07","2020-12-14","2020-12-21","2020-12-28","2021-01-04",
+               "2021-01-11","2021-01-18","2021-01-25","2021-02-01","2021-02-08",
+               "2021-02-15")
> endweek   <- c("2020-12-14","2020-12-21","2020-12-28","2021-01-04","2021-01-11",
+               "2021-01-18","2021-01-25","2021-02-01","2021-02-08","2021-02-15",
+               "2021-02-22")
> 
> # initialise lists for results and plots
> results_tpp <- results_primis <- pt_plot <- vector("list", length(startweek))
> 
> for (i in 1:length(startweek)) {
+   
+   # print iteration
+   print(paste("Week", i))
+   print(paste("Start date", startweek[i]))
+ 
+   # TPP
+   print("TPP")
+ 
+   # positive test in week
+   week_df_tpp <- df_input_tpp %>% 
+     mutate(pos_test_in_week = positive_test_1_date > startweek[i] &
+              positive_test_1_date <= endweek[i])
+   print("Week dataset dimensions")
+   print(dim(week_df_tpp))
+   # print(class(week_df_tpp$pos_test_in_week))
+   print("Positive tests in week")
+   print(table(week_df_tpp$pos_test_in_week))
+   
+   # pt_plot[[i]] <- df_input %>% 
+   #   drop_na(age, pos_test_in_week) %>%
+   #   filter(age >= 18) %>%
+   #   ggplot(aes(x = age, y = pos_test_in_week)) + 
+   #   geom_point() + 
+   #   theme_bw()
+   # 
+   # # save plots
+   # ggsave(
+   #   plot = pt_plot[[i]],
+   #   filename = paste0("pt_plot_week_", i, ".png"),
+   #   path = here::here("output"),
+   #   units = "cm",
+   #   height = 15,
+   #   width = 15
+   # )
+   
+   # fit IV estimator
+   ivfit <- try(tsls(as.numeric(pos_test_in_week) ~ age, ~ gr80, 
+                 data = week_df_tpp))
+   if (class(ivfit) != "try-error") {
+     results_tpp[[i]] <- ivfit
+     print(summary(ivfit))
+     print(cbind(coef(ivfit), confint.default(ivfit)))
+   }
+ 
+   # logistic regression of outcome on instrument
+   print("Logistic regression of outcome on instrument")
+   logreg <- glm(pos_test_in_week ~ gr80, family = "binomial", data = week_df_tpp)
+   if (class(logreg) != "try-error") {
+     print(summary(logreg))
+     print(exp(cbind(coef(logreg), confint.default(logreg))))
+   }
+ 
+   # primis
+   print("primis")
+ 
+   # positive test in week
+   week_df_primis <- df_input_primis %>% 
+     mutate(pos_test_in_week = positive_test_1_date > startweek[i] &
+              positive_test_1_date <= endweek[i])
+   print("Week dataset dimensions")
+   print(dim(week_df_primis))
+   # print(class(week_df_primis$pos_test_in_week))
+   print("Positive tests in week")
+   print(table(week_df_primis$pos_test_in_week))
+ 
+     # fit IV estimator
+   ivfit <- try(tsls(as.numeric(pos_test_in_week) ~ age, ~ gr80, 
+                 data = week_df_primis))
+   if (class(ivfit) != "try-error") {
+     results_primis[[i]] <- ivfit
+     print(summary(ivfit))
+     print(cbind(coef(ivfit), confint.default(ivfit)))
+   }
+ 
+   # logistic regression of outcome on instrument
+   print("Logistic regression of outcome on instrument")
+   logreg <- try(glm(pos_test_in_week ~ gr80, family = "binomial", data = week_df_tpp))
+   if (class(logreg) != "try-error") {
+     print(summary(logreg))
+     print(exp(cbind(coef(logreg), confint.default(logreg))))
+   }
+ }
[1] "Week 1"
[1] "Start date 2020-12-07"
[1] "TPP"
[1] "Week dataset dimensions"
[1] 9000   38
[1] "Positive tests in week"

FALSE  TRUE 
 7204     4 

 2SLS Estimates

Model Formula: as.numeric(pos_test_in_week) ~ age

Instruments: ~gr80

Residuals:
      Min.    1st Qu.     Median       Mean    3rd Qu.       Max. 
-0.0010408 -0.0007846 -0.0005651  0.0000000 -0.0003333  0.9998618 

                 Estimate    Std. Error  t value Pr(>|t|)
(Intercept)  1.040752e-03  1.175041e-03  0.88572   0.3758
age         -1.219677e-05  2.866641e-05 -0.42547   0.6705

Residual standard error: 0.0235537 on 7206 degrees of freedom

                                  2.5 %       97.5 %
(Intercept)  1.040752e-03 -1.262285e-03 3.343790e-03
age         -1.219677e-05 -6.838191e-05 4.398837e-05
[1] "Logistic regression of outcome on instrument"

Call:
glm(formula = pos_test_in_week ~ gr80, family = "binomial", data = week_df_tpp)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.0341  -0.0341  -0.0341  -0.0341   3.8607  

Coefficients:
             Estimate Std. Error z value Pr(>|z|)    
(Intercept)   -7.4518     0.5001 -14.899   <2e-16 ***
gr80         -14.1142  1654.9610  -0.009    0.993    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 67.971  on 7207  degrees of freedom
Residual deviance: 67.617  on 7206  degrees of freedom
  (1792 observations deleted due to missingness)
AIC: 71.617

Number of Fisher Scoring iterations: 20

                                2.5 %      97.5 %
(Intercept) 5.803831e-04 0.0002177662 0.001546817
gr80        7.417554e-07 0.0000000000         Inf
[1] "primis"
[1] "Week dataset dimensions"
[1] 9000   38
[1] "Positive tests in week"

FALSE  TRUE 
 7199     4 

 2SLS Estimates

Model Formula: as.numeric(pos_test_in_week) ~ age

Instruments: ~gr80

Residuals:
      Min.    1st Qu.     Median       Mean    3rd Qu.       Max. 
-0.0010398 -0.0007903 -0.0005651  0.0000000 -0.0003338  0.9998609 

                 Estimate    Std. Error  t value Pr(>|t|)
(Intercept)  1.039827e-03  1.157154e-03  0.89861  0.36889
age         -1.217240e-05  2.822262e-05 -0.43130  0.66626

Residual standard error: 0.0235619 on 7201 degrees of freedom

                                  2.5 %       97.5 %
(Intercept)  0.0010398273 -1.228152e-03 3.307807e-03
age         -0.0000121724 -6.748773e-05 4.314293e-05
[1] "Logistic regression of outcome on instrument"

Call:
glm(formula = pos_test_in_week ~ gr80, family = "binomial", data = week_df_tpp)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.0341  -0.0341  -0.0341  -0.0341   3.8607  

Coefficients:
             Estimate Std. Error z value Pr(>|z|)    
(Intercept)   -7.4518     0.5001 -14.899   <2e-16 ***
gr80         -14.1142  1654.9610  -0.009    0.993    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 67.971  on 7207  degrees of freedom
Residual deviance: 67.617  on 7206  degrees of freedom
  (1792 observations deleted due to missingness)
AIC: 71.617

Number of Fisher Scoring iterations: 20

                                2.5 %      97.5 %
(Intercept) 5.803831e-04 0.0002177662 0.001546817
gr80        7.417554e-07 0.0000000000         Inf
[1] "Week 2"
[1] "Start date 2020-12-14"
[1] "TPP"
[1] "Week dataset dimensions"
[1] 9000   38
[1] "Positive tests in week"

FALSE  TRUE 
 7206     2 

 2SLS Estimates

Model Formula: as.numeric(pos_test_in_week) ~ age

Instruments: ~gr80

Residuals:
      Min.    1st Qu.     Median       Mean    3rd Qu.       Max. 
-0.0005204 -0.0003923 -0.0002825  0.0000000 -0.0001667  0.9995589 

                 Estimate    Std. Error  t value Pr(>|t|)
(Intercept)  5.203762e-04  8.308667e-04  0.62631  0.53113
age         -6.098387e-06  2.026991e-05 -0.30086  0.76353

Residual standard error: 0.0166547 on 7206 degrees of freedom

                                  2.5 %       97.5 %
(Intercept)  5.203762e-04 -1.108093e-03 0.0021488450
age         -6.098387e-06 -4.582668e-05 0.0000336299
[1] "Logistic regression of outcome on instrument"

Call:
glm(formula = pos_test_in_week ~ gr80, family = "binomial", data = week_df_tpp)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.0241  -0.0241  -0.0241  -0.0241   4.0362  

Coefficients:
             Estimate Std. Error z value Pr(>|z|)    
(Intercept)   -8.1453     0.7072 -11.517   <2e-16 ***
gr80         -14.4208  2728.5693  -0.005    0.996    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 36.759  on 7207  degrees of freedom
Residual deviance: 36.582  on 7206  degrees of freedom
  (1792 observations deleted due to missingness)
AIC: 40.582

Number of Fisher Scoring iterations: 21

                                2.5 %      97.5 %
(Intercept) 2.901073e-04 7.254058e-05 0.001160209
gr80        5.459115e-07 0.000000e+00         Inf
[1] "primis"
[1] "Week dataset dimensions"
[1] 9000   38
[1] "Positive tests in week"

FALSE  TRUE 
 7201     2 

 2SLS Estimates

Model Formula: as.numeric(pos_test_in_week) ~ age

Instruments: ~gr80

Residuals:
      Min.    1st Qu.     Median       Mean    3rd Qu.       Max. 
-0.0005199 -0.0003951 -0.0002826  0.0000000 -0.0001669  0.9995592 

                 Estimate    Std. Error  t value Pr(>|t|)
(Intercept)  5.199136e-04  8.182188e-04  0.63542  0.52517
age         -6.086200e-06  1.995611e-05 -0.30498  0.76039

Residual standard error: 0.0166605 on 7201 degrees of freedom

                                  2.5 %       97.5 %
(Intercept)  0.0005199136 -1.083766e-03 2.123593e-03
age         -0.0000060862 -4.519945e-05 3.302705e-05
[1] "Logistic regression of outcome on instrument"

Call:
glm(formula = pos_test_in_week ~ gr80, family = "binomial", data = week_df_tpp)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.0241  -0.0241  -0.0241  -0.0241   4.0362  

Coefficients:
             Estimate Std. Error z value Pr(>|z|)    
(Intercept)   -8.1453     0.7072 -11.517   <2e-16 ***
gr80         -14.4208  2728.5693  -0.005    0.996    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 36.759  on 7207  degrees of freedom
Residual deviance: 36.582  on 7206  degrees of freedom
  (1792 observations deleted due to missingness)
AIC: 40.582

Number of Fisher Scoring iterations: 21

                                2.5 %      97.5 %
(Intercept) 2.901073e-04 7.254058e-05 0.001160209
gr80        5.459115e-07 0.000000e+00         Inf
[1] "Week 3"
[1] "Start date 2020-12-21"
[1] "TPP"
[1] "Week dataset dimensions"
[1] 9000   38
[1] "Positive tests in week"

FALSE  TRUE 
 7199     9 

 2SLS Estimates

Model Formula: as.numeric(pos_test_in_week) ~ age

Instruments: ~gr80

Residuals:
      Min.    1st Qu.     Median       Mean    3rd Qu.       Max. 
-0.0041370 -0.0020299 -0.0012129  0.0000000 -0.0004281  0.9994752 

                 Estimate    Std. Error  t value Pr(>|t|)
(Intercept) -4.641909e-04  1.762400e-03 -0.26339  0.79226
age          4.300145e-05  4.299569e-05  1.00013  0.31728

Residual standard error: 0.0353274 on 7206 degrees of freedom

                                  2.5 %       97.5 %
(Intercept) -4.641909e-04 -3.918432e-03 0.0029900501
age          4.300145e-05 -4.126856e-05 0.0001272715
[1] "Logistic regression of outcome on instrument"

Call:
glm(formula = pos_test_in_week ~ gr80, family = "binomial", data = week_df_tpp)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.0801  -0.0482  -0.0482  -0.0482   3.6768  

Coefficients:
            Estimate Std. Error z value Pr(>|z|)    
(Intercept)  -6.7581     0.3537 -19.104   <2e-16 ***
gr80          1.0183     1.0622   0.959    0.338    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 138.33  on 7207  degrees of freedom
Residual deviance: 137.62  on 7206  degrees of freedom
  (1792 observations deleted due to missingness)
AIC: 141.62

Number of Fisher Scoring iterations: 9

                              2.5 %       97.5 %
(Intercept) 0.00116144 0.0005806132  0.002323308
gr80        2.76848874 0.3451938308 22.203554119
[1] "primis"
[1] "Week dataset dimensions"
[1] 9000   38
[1] "Positive tests in week"

FALSE  TRUE 
 7195     8 

 2SLS Estimates

Model Formula: as.numeric(pos_test_in_week) ~ age

Instruments: ~gr80

Residuals:
      Min.    1st Qu.     Median       Mean    3rd Qu.       Max. 
-0.0040776 -0.0019141 -0.0010752  0.0000000 -0.0002363  0.9996313 

                 Estimate    Std. Error  t value Pr(>|t|)
(Intercept) -6.468109e-04  1.636369e-03 -0.39527  0.69265
age          4.415348e-05  3.991053e-05  1.10631  0.26863

Residual standard error: 0.0333197 on 7201 degrees of freedom

                                  2.5 %       97.5 %
(Intercept) -6.468109e-04 -3.854034e-03 0.0025604126
age          4.415348e-05 -3.406972e-05 0.0001223767
[1] "Logistic regression of outcome on instrument"

Call:
glm(formula = pos_test_in_week ~ gr80, family = "binomial", data = week_df_tpp)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.0801  -0.0482  -0.0482  -0.0482   3.6768  

Coefficients:
            Estimate Std. Error z value Pr(>|z|)    
(Intercept)  -6.7581     0.3537 -19.104   <2e-16 ***
gr80          1.0183     1.0622   0.959    0.338    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 138.33  on 7207  degrees of freedom
Residual deviance: 137.62  on 7206  degrees of freedom
  (1792 observations deleted due to missingness)
AIC: 141.62

Number of Fisher Scoring iterations: 9

                              2.5 %       97.5 %
(Intercept) 0.00116144 0.0005806132  0.002323308
gr80        2.76848874 0.3451938308 22.203554119
[1] "Week 4"
[1] "Start date 2020-12-28"
[1] "TPP"
[1] "Week dataset dimensions"
[1] 9000   38
[1] "Positive tests in week"

FALSE  TRUE 
 7197    11 

 2SLS Estimates

Model Formula: as.numeric(pos_test_in_week) ~ age

Instruments: ~gr80

Residuals:
      Min.    1st Qu.     Median       Mean    3rd Qu.       Max. 
-0.0040048 -0.0021966 -0.0014954  0.0000000 -0.0007942  0.9998700 

                Estimate   Std. Error t value Pr(>|t|)
(Intercept) 5.618530e-05 1.947720e-03 0.02885  0.97699
age         3.690306e-05 4.751677e-05 0.77663  0.43740

Residual standard error: 0.0390421 on 7206 degrees of freedom

                                 2.5 %       97.5 %
(Intercept) 5.618530e-05 -3.761276e-03 0.0038736461
age         3.690306e-05 -5.622809e-05 0.0001300342
[1] "Logistic regression of outcome on instrument"

Call:
glm(formula = pos_test_in_week ~ gr80, family = "binomial", data = week_df_tpp)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.0801  -0.0539  -0.0539  -0.0539   3.6156  

Coefficients:
            Estimate Std. Error z value Pr(>|z|)    
(Intercept)  -6.5347     0.3165 -20.650   <2e-16 ***
gr80          0.7949     1.0504   0.757    0.449    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 164.65  on 7207  degrees of freedom
Residual deviance: 164.19  on 7206  degrees of freedom
  (1792 observations deleted due to missingness)
AIC: 168.19

Number of Fisher Scoring iterations: 9

                               2.5 %       97.5 %
(Intercept) 0.001452222 0.0007810262  0.002700227
gr80        2.214147910 0.2825509017 17.350682434
[1] "primis"
[1] "Week dataset dimensions"
[1] 9000   38
[1] "Positive tests in week"

FALSE  TRUE 
 7193    10 

 2SLS Estimates

Model Formula: as.numeric(pos_test_in_week) ~ age

Instruments: ~gr80

Residuals:
      Min.    1st Qu.     Median       Mean    3rd Qu.       Max. 
-0.0039463 -0.0020810 -0.0013577  0.0000000 -0.0006344  1.0000508 

                 Estimate    Std. Error  t value Pr(>|t|)
(Intercept) -1.268973e-04  1.829080e-03 -0.06938  0.94469
age          3.806728e-05  4.461069e-05  0.85332  0.39351

Residual standard error: 0.0372436 on 7201 degrees of freedom

                                  2.5 %       97.5 %
(Intercept) -1.268973e-04 -3.711827e-03 0.0034580328
age          3.806728e-05 -4.936807e-05 0.0001255026
[1] "Logistic regression of outcome on instrument"

Call:
glm(formula = pos_test_in_week ~ gr80, family = "binomial", data = week_df_tpp)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.0801  -0.0539  -0.0539  -0.0539   3.6156  

Coefficients:
            Estimate Std. Error z value Pr(>|z|)    
(Intercept)  -6.5347     0.3165 -20.650   <2e-16 ***
gr80          0.7949     1.0504   0.757    0.449    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 164.65  on 7207  degrees of freedom
Residual deviance: 164.19  on 7206  degrees of freedom
  (1792 observations deleted due to missingness)
AIC: 168.19

Number of Fisher Scoring iterations: 9

                               2.5 %       97.5 %
(Intercept) 0.001452222 0.0007810262  0.002700227
gr80        2.214147910 0.2825509017 17.350682434
[1] "Week 5"
[1] "Start date 2021-01-04"
[1] "TPP"
[1] "Week dataset dimensions"
[1] 9000   38
[1] "Positive tests in week"

FALSE  TRUE 
 7176    32 

 2SLS Estimates

Model Formula: as.numeric(pos_test_in_week) ~ age

Instruments: ~gr80

Residuals:
     Min.   1st Qu.    Median      Mean   3rd Qu.      Max. 
-0.007349 -0.005227 -0.004404  0.000000 -0.003580  0.997069 

                Estimate   Std. Error t value Pr(>|t|)
(Intercept) 2.714251e-03 3.316504e-03 0.81841  0.41315
age         4.331419e-05 8.090977e-05 0.53534  0.59243

Residual standard error: 0.0664794 on 7206 degrees of freedom

                                2.5 %       97.5 %
(Intercept) 2.714251e-03 -0.003785977 0.0092144802
age         4.331419e-05 -0.000115266 0.0002018944
[1] "Logistic regression of outcome on instrument"

Call:
glm(formula = pos_test_in_week ~ gr80, family = "binomial", data = week_df_tpp)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.1134  -0.0934  -0.0934  -0.0934   3.2977  

Coefficients:
            Estimate Std. Error z value Pr(>|z|)    
(Intercept)  -5.4331     0.1830 -29.694   <2e-16 ***
gr80          0.3897     0.7326   0.532    0.595    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 410.56  on 7207  degrees of freedom
Residual deviance: 410.31  on 7206  degrees of freedom
  (1792 observations deleted due to missingness)
AIC: 414.31

Number of Fisher Scoring iterations: 8

                              2.5 %      97.5 %
(Intercept) 0.004369356 0.003052609 0.006254084
gr80        1.476559140 0.351284939 6.206434303
[1] "primis"
[1] "Week dataset dimensions"
[1] 9000   38
[1] "Positive tests in week"

FALSE  TRUE 
 7172    31 

 2SLS Estimates

Model Formula: as.numeric(pos_test_in_week) ~ age

Instruments: ~gr80

Residuals:
     Min.   1st Qu.    Median      Mean   3rd Qu.      Max. 
-0.005332 -0.004790 -0.004325  0.000000 -0.003834  0.996838 

                 Estimate    Std. Error  t value Pr(>|t|)  
(Intercept)  5.332196e-03  3.215921e-03  1.65806 0.097349 .
age         -2.583782e-05  7.843533e-05 -0.32942 0.741851  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.0654824 on 7201 degrees of freedom

                                  2.5 %       97.5 %
(Intercept)  5.332196e-03 -0.0009708931 0.0116352847
age         -2.583782e-05 -0.0001795682 0.0001278926
[1] "Logistic regression of outcome on instrument"

Call:
glm(formula = pos_test_in_week ~ gr80, family = "binomial", data = week_df_tpp)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.1134  -0.0934  -0.0934  -0.0934   3.2977  

Coefficients:
            Estimate Std. Error z value Pr(>|z|)    
(Intercept)  -5.4331     0.1830 -29.694   <2e-16 ***
gr80          0.3897     0.7326   0.532    0.595    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 410.56  on 7207  degrees of freedom
Residual deviance: 410.31  on 7206  degrees of freedom
  (1792 observations deleted due to missingness)
AIC: 414.31

Number of Fisher Scoring iterations: 8

                              2.5 %      97.5 %
(Intercept) 0.004369356 0.003052609 0.006254084
gr80        1.476559140 0.351284939 6.206434303
[1] "Week 6"
[1] "Start date 2021-01-11"
[1] "TPP"
[1] "Week dataset dimensions"
[1] 9000   38
[1] "Positive tests in week"

FALSE  TRUE 
 7155    53 

 2SLS Estimates

Model Formula: as.numeric(pos_test_in_week) ~ age

Instruments: ~gr80

Residuals:
     Min.   1st Qu.    Median      Mean   3rd Qu.      Max. 
-0.008178 -0.007743 -0.007370  0.000000 -0.006977  0.993728 

                 Estimate    Std. Error  t value Pr(>|t|)  
(Intercept)  8.178201e-03  4.263107e-03  1.91837 0.055104 .
age         -2.071888e-05  1.040032e-04 -0.19921 0.842101  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.0854541 on 7206 degrees of freedom

                                  2.5 %       97.5 %
(Intercept)  8.178201e-03 -0.0001773350 0.0165337371
age         -2.071888e-05 -0.0002245614 0.0001831236
[1] "Logistic regression of outcome on instrument"

Call:
glm(formula = pos_test_in_week ~ gr80, family = "binomial", data = week_df_tpp)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.1218  -0.1218  -0.1218  -0.1218   3.1780  

Coefficients:
            Estimate Std. Error z value Pr(>|z|)    
(Intercept)  -4.8994     0.1405 -34.862   <2e-16 ***
gr80         -0.1440     0.7230  -0.199    0.842    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 626.35  on 7207  degrees of freedom
Residual deviance: 626.31  on 7206  degrees of freedom
  (1792 observations deleted due to missingness)
AIC: 630.31

Number of Fisher Scoring iterations: 7

                            2.5 %     97.5 %
(Intercept) 0.007450694 0.0056568 0.00981347
gr80        0.865907709 0.2099049 3.57207491
[1] "primis"
[1] "Week dataset dimensions"
[1] 9000   38
[1] "Positive tests in week"

FALSE  TRUE 
 7154    49 

 2SLS Estimates

Model Formula: as.numeric(pos_test_in_week) ~ age

Instruments: ~gr80

Residuals:
     Min.   1st Qu.    Median      Mean   3rd Qu.      Max. 
-0.010011 -0.008318 -0.006868  0.000000 -0.005336  0.996599 

                 Estimate    Std. Error  t value Pr(>|t|)  
(Intercept)  1.001142e-02  4.039483e-03  2.47839  0.01322 *
age         -8.061362e-05  9.852176e-05 -0.81823  0.41325  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.0822518 on 7201 degrees of freedom

                                  2.5 %       97.5 %
(Intercept)  1.001142e-02  0.0020941774 0.0179286595
age         -8.061362e-05 -0.0002737127 0.0001124855
[1] "Logistic regression of outcome on instrument"

Call:
glm(formula = pos_test_in_week ~ gr80, family = "binomial", data = week_df_tpp)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.1218  -0.1218  -0.1218  -0.1218   3.1780  

Coefficients:
            Estimate Std. Error z value Pr(>|z|)    
(Intercept)  -4.8994     0.1405 -34.862   <2e-16 ***
gr80         -0.1440     0.7230  -0.199    0.842    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 626.35  on 7207  degrees of freedom
Residual deviance: 626.31  on 7206  degrees of freedom
  (1792 observations deleted due to missingness)
AIC: 630.31

Number of Fisher Scoring iterations: 7

                            2.5 %     97.5 %
(Intercept) 0.007450694 0.0056568 0.00981347
gr80        0.865907709 0.2099049 3.57207491
[1] "Week 7"
[1] "Start date 2021-01-18"
[1] "TPP"
[1] "Week dataset dimensions"
[1] 9000   38
[1] "Positive tests in week"

FALSE  TRUE 
 7064   144 

 2SLS Estimates

Model Formula: as.numeric(pos_test_in_week) ~ age

Instruments: ~gr80

Residuals:
    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
-0.02624 -0.02294 -0.01995  0.00000 -0.01696  0.98933 

                 Estimate    Std. Error  t value   Pr(>|t|)    
(Intercept)  0.0262435491  0.0069816159  3.75895 0.00017198 ***
age         -0.0001573071  0.0001703242 -0.92357 0.35573873    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.1399467 on 7206 degrees of freedom

                                  2.5 %       97.5 %
(Intercept)  0.0262435491  0.0125598333 0.0399272649
age         -0.0001573071 -0.0004911364 0.0001765222
[1] "Logistic regression of outcome on instrument"

Call:
glm(formula = pos_test_in_week ~ gr80, family = "binomial", data = week_df_tpp)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.2025  -0.2025  -0.2025  -0.2025   2.9518  

Coefficients:
            Estimate Std. Error z value Pr(>|z|)    
(Intercept) -3.87654    0.08539 -45.400   <2e-16 ***
gr80        -0.46726    0.51043  -0.915     0.36    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 1412.1  on 7207  degrees of freedom
Residual deviance: 1411.1  on 7206  degrees of freedom
  (1792 observations deleted due to missingness)
AIC: 1415.1

Number of Fisher Scoring iterations: 7

                           2.5 %     97.5 %
(Intercept) 0.02072232 0.0175290 0.02449738
gr80        0.62671614 0.2304588 1.70430914
[1] "primis"
[1] "Week dataset dimensions"
[1] 9000   38
[1] "Positive tests in week"

FALSE  TRUE 
 7066   137 

 2SLS Estimates

Model Formula: as.numeric(pos_test_in_week) ~ age

Instruments: ~gr80

Residuals:
    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
-0.02198 -0.02042 -0.01901  0.00000 -0.01759  0.98539 

                 Estimate    Std. Error  t value  Pr(>|t|)   
(Intercept)  0.0219817565  0.0067086557  3.27663 0.0010555 **
age         -0.0000744133  0.0001636221 -0.45479 0.6492757   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.1366014 on 7201 degrees of freedom

                                  2.5 %       97.5 %
(Intercept)  0.0219817565  0.0088330329 0.0351304800
age         -0.0000744133 -0.0003951067 0.0002462801
[1] "Logistic regression of outcome on instrument"

Call:
glm(formula = pos_test_in_week ~ gr80, family = "binomial", data = week_df_tpp)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.2025  -0.2025  -0.2025  -0.2025   2.9518  

Coefficients:
            Estimate Std. Error z value Pr(>|z|)    
(Intercept) -3.87654    0.08539 -45.400   <2e-16 ***
gr80        -0.46726    0.51043  -0.915     0.36    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 1412.1  on 7207  degrees of freedom
Residual deviance: 1411.1  on 7206  degrees of freedom
  (1792 observations deleted due to missingness)
AIC: 1415.1

Number of Fisher Scoring iterations: 7

                           2.5 %     97.5 %
(Intercept) 0.02072232 0.0175290 0.02449738
gr80        0.62671614 0.2304588 1.70430914
[1] "Week 8"
[1] "Start date 2021-01-25"
[1] "TPP"
[1] "Week dataset dimensions"
[1] 9000   38
[1] "Positive tests in week"

FALSE  TRUE 
 6894   314 

 2SLS Estimates

Model Formula: as.numeric(pos_test_in_week) ~ age

Instruments: ~gr80

Residuals:
    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
-0.05969 -0.04768 -0.04288  0.00000 -0.03832  0.96600 

                Estimate   Std. Error t value   Pr(>|t|)    
(Intercept) 0.0339990361 0.0101854142 3.33801 0.00084808 ***
age         0.0002401044 0.0002484844 0.96628 0.33393861    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.2041669 on 7206 degrees of freedom

                                2.5 %       97.5 %
(Intercept) 0.0339990361  0.014035991 0.0539620812
age         0.0002401044 -0.000246916 0.0007271249
[1] "Logistic regression of outcome on instrument"

Call:
glm(formula = pos_test_in_week ~ gr80, family = "binomial", data = week_df_tpp)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.3347  -0.2967  -0.2967  -0.2967   2.5080  

Coefficients:
            Estimate Std. Error z value Pr(>|z|)    
(Intercept) -3.10094    0.05932 -52.277   <2e-16 ***
gr80         0.24718    0.25638   0.964    0.335    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 2582.0  on 7207  degrees of freedom
Residual deviance: 2581.1  on 7206  degrees of freedom
  (1792 observations deleted due to missingness)
AIC: 2585.1

Number of Fisher Scoring iterations: 6

                            2.5 %    97.5 %
(Intercept) 0.04500682 0.04006705 0.0505556
gr80        1.28040861 0.77466787 2.1163214
[1] "primis"
[1] "Week dataset dimensions"
[1] 9000   38
[1] "Positive tests in week"

FALSE  TRUE 
 6876   327 

 2SLS Estimates

Model Formula: as.numeric(pos_test_in_week) ~ age

Instruments: ~gr80

Residuals:
    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
-0.05218 -0.04713 -0.04511  0.00000 -0.04310  0.95862 

                Estimate   Std. Error t value   Pr(>|t|)    
(Intercept) 0.0413824316 0.0102256427 4.04693 5.2437e-05 ***
age         0.0001008788 0.0002494003 0.40449    0.68587    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.2082141 on 7201 degrees of freedom

                                 2.5 %       97.5 %
(Intercept) 0.0413824316  0.0213405403 0.0614243230
age         0.0001008788 -0.0003879369 0.0005896944
[1] "Logistic regression of outcome on instrument"

Call:
glm(formula = pos_test_in_week ~ gr80, family = "binomial", data = week_df_tpp)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.3347  -0.2967  -0.2967  -0.2967   2.5080  

Coefficients:
            Estimate Std. Error z value Pr(>|z|)    
(Intercept) -3.10094    0.05932 -52.277   <2e-16 ***
gr80         0.24718    0.25638   0.964    0.335    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 2582.0  on 7207  degrees of freedom
Residual deviance: 2581.1  on 7206  degrees of freedom
  (1792 observations deleted due to missingness)
AIC: 2585.1

Number of Fisher Scoring iterations: 6

                            2.5 %    97.5 %
(Intercept) 0.04500682 0.04006705 0.0505556
gr80        1.28040861 0.77466787 2.1163214
[1] "Week 9"
[1] "Start date 2021-02-01"
[1] "TPP"
[1] "Week dataset dimensions"
[1] 9000   38
[1] "Positive tests in week"

FALSE  TRUE 
 6382   826 

 2SLS Estimates

Model Formula: as.numeric(pos_test_in_week) ~ age

Instruments: ~gr80

Residuals:
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
-0.1394 -0.1206 -0.1124  0.0000 -0.1043  0.9001 

                Estimate   Std. Error t value   Pr(>|t|)    
(Intercept) 0.0998741269 0.0158965042 6.28277 3.5194e-10 ***
age         0.0003695779 0.0003878127 0.95298    0.34063    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.3186459 on 7206 degrees of freedom

                                2.5 %      97.5 %
(Intercept) 0.0998741269  0.068717551 0.131030703
age         0.0003695779 -0.000390521 0.001129677
[1] "Logistic regression of outcome on instrument"

Call:
glm(formula = pos_test_in_week ~ gr80, family = "binomial", data = week_df_tpp)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.5308  -0.4916  -0.4916  -0.4916   2.0847  

Coefficients:
            Estimate Std. Error z value Pr(>|z|)    
(Intercept) -2.05216    0.03791 -54.127   <2e-16 ***
gr80         0.16362    0.17181   0.952    0.341    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 5132.3  on 7207  degrees of freedom
Residual deviance: 5131.4  on 7206  degrees of freedom
  (1792 observations deleted due to missingness)
AIC: 5135.4

Number of Fisher Scoring iterations: 4

                          2.5 %    97.5 %
(Intercept) 0.1284569 0.1192573 0.1383662
gr80        1.1777611 0.8410363 1.6493000
[1] "primis"
[1] "Week dataset dimensions"
[1] 9000   38
[1] "Positive tests in week"

FALSE  TRUE 
 6374   829 

 2SLS Estimates

Model Formula: as.numeric(pos_test_in_week) ~ age

Instruments: ~gr80

Residuals:
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
-0.1251 -0.1175 -0.1142  0.0000 -0.1110  0.8908 

                Estimate   Std. Error t value Pr(>|t|)    
(Intercept) 0.1091720478 0.0156757821 6.96438 3.59e-12 ***
age         0.0001487030 0.0003823275 0.38894  0.69733    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.3191896 on 7201 degrees of freedom

                                2.5 %       97.5 %
(Intercept) 0.109172048  0.0784480795 0.1398960162
age         0.000148703 -0.0006006452 0.0008980512
[1] "Logistic regression of outcome on instrument"

Call:
glm(formula = pos_test_in_week ~ gr80, family = "binomial", data = week_df_tpp)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.5308  -0.4916  -0.4916  -0.4916   2.0847  

Coefficients:
            Estimate Std. Error z value Pr(>|z|)    
(Intercept) -2.05216    0.03791 -54.127   <2e-16 ***
gr80         0.16362    0.17181   0.952    0.341    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 5132.3  on 7207  degrees of freedom
Residual deviance: 5131.4  on 7206  degrees of freedom
  (1792 observations deleted due to missingness)
AIC: 5135.4

Number of Fisher Scoring iterations: 4

                          2.5 %    97.5 %
(Intercept) 0.1284569 0.1192573 0.1383662
gr80        1.1777611 0.8410363 1.6493000
[1] "Week 10"
[1] "Start date 2021-02-08"
[1] "TPP"
[1] "Week dataset dimensions"
[1] 9000   38
[1] "Positive tests in week"

FALSE  TRUE 
 5418  1790 

 2SLS Estimates

Model Formula: as.numeric(pos_test_in_week) ~ age

Instruments: ~gr80

Residuals:
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
-0.2693 -0.2551 -0.2419  0.0000 -0.2193  0.7850 

                 Estimate    Std. Error  t value Pr(>|t|)    
(Intercept)  0.2693248116  0.0215538730 12.49543   <2e-16 ***
age         -0.0005269632  0.0005258304 -1.00215   0.3163    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.432048 on 7206 degrees of freedom

                                 2.5 %       97.5 %
(Intercept)  0.2693248116  0.227079997 0.3115696264
age         -0.0005269632 -0.001557572 0.0005036455
[1] "Logistic regression of outcome on instrument"

Call:
glm(formula = pos_test_in_week ~ gr80, family = "binomial", data = week_df_tpp)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.7575  -0.7575  -0.7575  -0.7128   1.7289  

Coefficients:
            Estimate Std. Error z value Pr(>|z|)    
(Intercept) -1.10171    0.02783 -39.585   <2e-16 ***
gr80        -0.13873    0.13854  -1.001    0.317    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 8080.2  on 7207  degrees of freedom
Residual deviance: 8079.1  on 7206  degrees of freedom
  (1792 observations deleted due to missingness)
AIC: 8083.1

Number of Fisher Scoring iterations: 4

                          2.5 %    97.5 %
(Intercept) 0.3323029 0.3146617 0.3509332
gr80        0.8704594 0.6634765 1.1420141
[1] "primis"
[1] "Week dataset dimensions"
[1] 9000   38
[1] "Positive tests in week"

FALSE  TRUE 
 5441  1762 

 2SLS Estimates

Model Formula: as.numeric(pos_test_in_week) ~ age

Instruments: ~gr80

Residuals:
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
-0.2590 -0.2492 -0.2402  0.0000 -0.2265  0.7782 

                 Estimate    Std. Error  t value Pr(>|t|)    
(Intercept)  0.2590119313  0.0211111424 12.26897  < 2e-16 ***
age         -0.0003615678  0.0005148943 -0.70222  0.48257    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.4298642 on 7201 degrees of freedom

                                 2.5 %       97.5 %
(Intercept)  0.2590119313  0.217634852 0.3003890102
age         -0.0003615678 -0.001370742 0.0006476065
[1] "Logistic regression of outcome on instrument"

Call:
glm(formula = pos_test_in_week ~ gr80, family = "binomial", data = week_df_tpp)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.7575  -0.7575  -0.7575  -0.7128   1.7289  

Coefficients:
            Estimate Std. Error z value Pr(>|z|)    
(Intercept) -1.10171    0.02783 -39.585   <2e-16 ***
gr80        -0.13873    0.13854  -1.001    0.317    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 8080.2  on 7207  degrees of freedom
Residual deviance: 8079.1  on 7206  degrees of freedom
  (1792 observations deleted due to missingness)
AIC: 8083.1

Number of Fisher Scoring iterations: 4

                          2.5 %    97.5 %
(Intercept) 0.3323029 0.3146617 0.3509332
gr80        0.8704594 0.6634765 1.1420141
[1] "Week 11"
[1] "Start date 2021-02-15"
[1] "TPP"
[1] "Week dataset dimensions"
[1] 9000   38
[1] "Positive tests in week"

FALSE  TRUE 
 3185  4023 

 2SLS Estimates

Model Formula: as.numeric(pos_test_in_week) ~ age

Instruments: ~gr80

Residuals:
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
-0.5585 -0.5581  0.4416  0.0000  0.4419  0.4425 

                 Estimate    Std. Error  t value Pr(>|t|)    
(Intercept)  5.585129e-01  2.477821e-02 22.54049  < 2e-16 ***
age         -9.616687e-06  6.044917e-04 -0.01591  0.98731    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.49668 on 7206 degrees of freedom

                                 2.5 %      97.5 %
(Intercept)  5.585129e-01  0.509948500 0.607077302
age         -9.616687e-06 -0.001194399 0.001175165
[1] "Logistic regression of outcome on instrument"

Call:
glm(formula = pos_test_in_week ~ gr80, family = "binomial", data = week_df_tpp)

Deviance Residuals: 
   Min      1Q  Median      3Q     Max  
-1.278  -1.278   1.080   1.080   1.081  

Coefficients:
             Estimate Std. Error z value Pr(>|z|)    
(Intercept)  0.233656   0.024248   9.636   <2e-16 ***
gr80        -0.001854   0.116539  -0.016    0.987    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 9894.8  on 7207  degrees of freedom
Residual deviance: 9894.8  on 7206  degrees of freedom
  (1792 observations deleted due to missingness)
AIC: 9898.8

Number of Fisher Scoring iterations: 3

                          2.5 %   97.5 %
(Intercept) 1.2632097 1.2045785 1.324695
gr80        0.9981475 0.7943224 1.254274
[1] "primis"
[1] "Week dataset dimensions"
[1] 9000   38
[1] "Positive tests in week"

FALSE  TRUE 
 3159  4044 

 2SLS Estimates

Model Formula: as.numeric(pos_test_in_week) ~ age

Instruments: ~gr80

Residuals:
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
-0.5759 -0.5601  0.4312  0.0000  0.4397  0.4477 

                Estimate   Std. Error  t value Pr(>|t|)    
(Intercept) 0.5523221858 0.0243709972 22.66309  < 2e-16 ***
age         0.0002288887 0.0005944012  0.38507  0.70019    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.4962412 on 7201 degrees of freedom

                                 2.5 %      97.5 %
(Intercept) 0.5523221858  0.5045559090 0.600088463
age         0.0002288887 -0.0009361163 0.001393894
[1] "Logistic regression of outcome on instrument"

Call:
glm(formula = pos_test_in_week ~ gr80, family = "binomial", data = week_df_tpp)

Deviance Residuals: 
   Min      1Q  Median      3Q     Max  
-1.278  -1.278   1.080   1.080   1.081  

Coefficients:
             Estimate Std. Error z value Pr(>|z|)    
(Intercept)  0.233656   0.024248   9.636   <2e-16 ***
gr80        -0.001854   0.116539  -0.016    0.987    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 9894.8  on 7207  degrees of freedom
Residual deviance: 9894.8  on 7206  degrees of freedom
  (1792 observations deleted due to missingness)
AIC: 9898.8

Number of Fisher Scoring iterations: 3

                          2.5 %   97.5 %
(Intercept) 1.2632097 1.2045785 1.324695
gr80        0.9981475 0.7943224 1.254274
There were 22 warnings (use warnings() to see them)
> 
> proc.time()
   user  system elapsed 
  1.762   0.061   2.121 
